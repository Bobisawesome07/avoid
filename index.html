<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avoid Responsibilities</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:ital,wght@0,300;0,400;0,700;1,700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Comic Neue', cursive;
            touch-action: manipulation; /* Prevents double tap to zoom on mobile */
        }
        .text-shadow {
            text-shadow: 3px 3px 0px rgba(0,0,0,0.2);
        }
        /* Hide scrollbars */
        ::-webkit-scrollbar {
            display: none;
        }
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    </style>
</head>
<body class="bg-amber-100 flex flex-col items-center justify-center min-h-screen overflow-hidden p-4">

    <div id="game-wrapper" class="w-full max-w-lg mx-auto">
        <div id="ui-top" class="text-center mb-2">
            <h1 class="text-4xl md:text-6xl font-bold text-red-600 text-shadow uppercase">Avoid Responsibilities</h1>
            <p id="score-display" class="text-2xl md:text-3xl font-bold text-slate-700 mt-1">Score: 0</p>
        </div>

        <div class="relative w-full" style="padding-bottom: 125%;"> <!-- Aspect ratio container -->
            <canvas id="gameCanvas" class="absolute top-0 left-0 w-full h-full border-4 border-black rounded-2xl bg-sky-300"></canvas>
            
            <!-- Game Over Screen -->
            <div id="game-over-screen" class="hidden absolute inset-0 bg-black bg-opacity-70 flex-col items-center justify-center text-center text-white p-4 rounded-xl">
                <h2 class="text-5xl font-bold text-red-500 animate-pulse">U DIED</h2>
                <p class="text-xl mt-2">Reality caught up with you.</p>
                <p id="final-score" class="text-lg mt-1">Final Score: 0</p>
                <button id="restart-btn" class="mt-6 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full text-2xl border-b-4 border-blue-800 active:border-b-0">
                    Try Again?
                </button>
            </div>

             <!-- Start Screen -->
            <div id="start-screen" class="absolute inset-0 bg-black bg-opacity-50 flex flex-col items-center justify-center text-center text-white p-4 rounded-xl">
                <h2 class="text-3xl font-bold">Instructions</h2>
                <p class="text-xl mt-2">Use Arrow Keys or Buttons to Move</p>
                <p class="text-xl mt-1">Dodge everything.</p>
                <button id="start-btn" class="mt-8 bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-10 rounded-full text-3xl border-b-4 border-green-800 active:border-b-0 animate-bounce">
                    START
                </button>
            </div>
        </div>

        <!-- On-screen controls for mobile -->
        <div id="touch-controls" class="flex justify-between w-full mt-4">
            <button id="left-btn" class="bg-slate-600 text-white font-bold py-4 w-1/2 mr-2 rounded-xl text-3xl border-b-4 border-slate-800 active:border-b-0 select-none">◀</button>
            <button id="right-btn" class="bg-slate-600 text-white font-bold py-4 w-1/2 ml-2 rounded-xl text-3xl border-b-4 border-slate-800 active:border-b-0 select-none">▶</button>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreDisplay = document.getElementById('score-display');
        const startScreen = document.getElementById('start-screen');
        const gameOverScreen = document.getElementById('game-over-screen');
        const finalScoreDisplay = document.getElementById('final-score');
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const leftBtn = document.getElementById('left-btn');
        const rightBtn = document.getElementById('right-btn');
        
        // --- Game Configuration ---
        let canvasWidth, canvasHeight;
        const responsibilities = [
            'Taxes', 'Laundry', 'Dishes', 'Emails', 'That Thing You Forgot', 
            'Student Loans', 'Existential Dread', 'Calling Your Mom', 'Watering Plants',
            'Taking Out Trash', 'Unexplained Back Pain', 'Cringe Memory from 2012'
        ];
        const playerEmoji = '🏃‍♂️';
        const responsibilityEmojis = ['🧾', '🗑️', '📧', '💸', '🧠', '🪴', '📞', '👕'];

        // --- Game State ---
        let player, fallingObjects, score, gameOver, gameSpeed, spawnTimer;
        let animationFrameId;
        let keys = {};
        let isMovingLeft = false;
        let isMovingRight = false;

        // --- Resize Canvas ---
        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
            canvasWidth = canvas.width;
            canvasHeight = canvas.height;
            // Re-initialize game elements on resize if a game is active
            if (player) {
                player.x = canvasWidth / 2;
                player.y = canvasHeight - 60;
                player.size = canvasWidth * 0.1;
            }
        }

        // --- Game Initialization ---
        function init() {
            score = 0;
            gameOver = false;
            gameSpeed = 2;
            spawnTimer = 0;
            fallingObjects = [];
            
            const playerSize = canvasWidth * 0.1;
            player = {
                x: canvasWidth / 2,
                y: canvasHeight - 60,
                size: playerSize,
                speed: 7,
            };

            scoreDisplay.textContent = 'Score: 0';
            gameOverScreen.classList.add('hidden');
            gameOverScreen.classList.remove('flex');
            startScreen.classList.add('hidden');
            
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
            }
            gameLoop();
        }

        // --- Player Movement ---
        window.addEventListener('keydown', (e) => { keys[e.key] = true; });
        window.addEventListener('keyup', (e) => { keys[e.key] = false; });

        // Touch controls
        leftBtn.addEventListener('touchstart', (e) => { e.preventDefault(); isMovingLeft = true; });
        leftBtn.addEventListener('touchend', () => { isMovingLeft = false; });
        rightBtn.addEventListener('touchstart', (e) => { e.preventDefault(); isMovingRight = true; });
        rightBtn.addEventListener('touchend', () => { isMovingRight = false; });

        function updatePlayer() {
            if ((keys['ArrowLeft'] || isMovingLeft) && player.x > player.size / 2) {
                player.x -= player.speed;
            }
            if ((keys['ArrowRight'] || isMovingRight) && player.x < canvasWidth - player.size / 2) {
                player.x += player.speed;
            }
        }

        // --- Falling Objects ---
        function spawnObject() {
            const size = canvasWidth * 0.12;
            const text = responsibilities[Math.floor(Math.random() * responsibilities.length)];
            const emoji = responsibilityEmojis[Math.floor(Math.random() * responsibilityEmojis.length)];
            fallingObjects.push({
                x: Math.random() * (canvasWidth - size),
                y: -size,
                size: size,
                text: text,
                emoji: emoji,
                speed: gameSpeed + Math.random() * 2,
            });
        }

        function updateObjects() {
            spawnTimer++;
            // Spawn objects faster as the score increases
            const spawnInterval = Math.max(20, 100 - score * 2);
            if (spawnTimer > spawnInterval) {
                spawnObject();
                spawnTimer = 0;
            }

            for (let i = fallingObjects.length - 1; i >= 0; i--) {
                const obj = fallingObjects[i];
                obj.y += obj.speed;

                // Remove object if it's off-screen
                if (obj.y > canvasHeight) {
                    fallingObjects.splice(i, 1);
                    score++;
                    scoreDisplay.textContent = `Score: ${score}`;
                    // Increase speed slightly with score
                    if (score % 5 === 0) {
                        gameSpeed += 0.2;
                    }
                }
            }
        }

        // --- Collision Detection ---
        function checkCollisions() {
            for (const obj of fallingObjects) {
                const dist = Math.hypot(player.x - (obj.x + obj.size / 2), player.y - (obj.y + obj.size / 2));
                if (dist < player.size / 2 + obj.size / 2) {
                    gameOver = true;
                }
            }
        }

        // --- Drawing ---
        function draw() {
            ctx.clearRect(0, 0, canvasWidth, canvasHeight);

            // Draw player
            ctx.font = `${player.size}px sans-serif`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(playerEmoji, player.x, player.y);

            // Draw falling objects
            for (const obj of fallingObjects) {
                // Draw emoji
                ctx.font = `${obj.size}px sans-serif`;
                ctx.fillText(obj.emoji, obj.x + obj.size / 2, obj.y + obj.size / 2);
                
                // Draw text below emoji
                ctx.font = `bold ${canvasWidth * 0.03}px 'Comic Neue'`;
                ctx.fillStyle = 'black';
                ctx.fillText(obj.text, obj.x + obj.size / 2, obj.y + obj.size + 10);
            }
        }
        
        // --- Game Over ---
        function handleGameOver() {
            cancelAnimationFrame(animationFrameId);
            finalScoreDisplay.textContent = `Final Score: ${score}`;
            gameOverScreen.classList.remove('hidden');
            gameOverScreen.classList.add('flex');
        }

        // --- Game Loop ---
        function gameLoop() {
            if (gameOver) {
                handleGameOver();
                return;
            }

            updatePlayer();
            updateObjects();
            checkCollisions();
            draw();

            animationFrameId = requestAnimationFrame(gameLoop);
        }

        // --- Event Listeners ---
        startBtn.addEventListener('click', () => {
             // Re-run resize on start to ensure dimensions are correct
            resizeCanvas();
            init();
        });
        
        restartBtn.addEventListener('click', () => {
            init();
        });

        window.addEventListener('resize', resizeCanvas);
        
        // Initial setup
        window.onload = () => {
            resizeCanvas();
        };

    </script>
</body>
</html>
